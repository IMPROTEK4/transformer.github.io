<!DOCTYPE html>
<html lang="en">
<head>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>View Data Log Feeder4</title>
    <link rel="icon" href="IMPROTECHS.jpg">
    <link rel="stylesheet" href="css/viewdata.css">
    <style>
        span {
            /* display: inline-block; */
            justify-content: center;
            align-content: center;
            margin: auto;
        }

        button {
            /* Variables */
            --button_radius: 17.5px;
            --button_color: #e8e8e8;
            --button_outline_color: #000000;
            font-size: 17px;
            font-weight: bold;
            margin-top: 30px;
            margin-left: 40px;
            margin-right: 560px;
            /* margin-bottom: -20px ; */
            border: none;
            border-radius: var(--button_radius);
            background: var(--button_outline_color);
            }

            .button_top {
            display: block;
            box-sizing: border-box;
            border: 2px solid var(--button_outline_color);
            border-radius: var(--button_radius);
            padding: 10px 20px;
            background: var(--button_color);
            color: var(--button_outline_color);
            transform: translateY(-0.2em);
            transition: transform 0.1s ease;
            }

            button:hover .button_top {
            /* Pull the button upwards when hovered */
            transform: translateY(-0.33em);
            }

            button:active .button_top {
            /* Push the button downwards when pressed */
            transform: translateY(0);
            }
    </style>

</head>
<body>
    <div class="container">
        <div class="topbar"> 
            <button onclick="resetData()">
                <span class="button_top"> Reset Data Log
                </span>
            </button>      
            <span id="label_title">FEEDER 4 DATA LOG</span>
        </div>

        <div class="midlebar">
            <!-- Active Power -->
            <div class="active_power"><h3>Active Power(W)</h3>
                <div class="phase_A">
                    <h4>Phase A</h4>
                    <textarea id="Textarea_ACT_phase_A"  readonly style="width: 71px; resize: none; height: 100%; background-color: azure; overflow: hidden;  text-align: center; color: black;" disabled></textarea>
                </div>
                <div class="phase_B">
                    <h4>Phase B</h4>
                    <textarea id="Textarea_ACT_phase_B"  readonly style="width: 71px; resize: none; height: 100%; background-color: azure; overflow: hidden; text-align: center; color: black;" disabled></textarea>
                </div>
                <div class="phase_C">
                    <h4>Phase C</h4>
                    <textarea id="Textarea_ACT_phase_C"  readonly style="width: 71.2px; resize: none; height: 100%; background-color: azure; overflow: hidden; text-align: center; color: black;" disabled></textarea>
                </div>
                <div class="total">
                    <h4>Total</h4>
                    <textarea id="Textarea_ACT_Total"  readonly style="width: 71px; resize: none; height: 100%; background-color: azure; overflow: hidden; text-align: center; color: black;" disabled></textarea>
                </div>
            </div>

            <!-- Reactive Power -->
            <div class="reactive_power"><h3>Reactive Power(VAR)</h3>
                <div class="phase_A">
                    <h4>Phase A</h4>
                    <textarea id="Textarea_REAC_phase_A" readonly style="width: 71px; resize: none; height: 100%; background-color: azure; overflow: hidden; text-align: center; color: black;" disabled></textarea>
                </div>
                <div class="phase_B">
                    <h4>Phase B</h4>
                    <textarea id="Textarea_REAC_phase_B" readonly style="width: 71px; resize: none; height: 100%; background-color: azure; overflow: hidden; text-align: center; color: black;" disabled></textarea>
                </div>
                <div class="phase_C">
                    <h4>Phase C</h4>
                    <textarea id="Textarea_REAC_phase_C" readonly style="width: 71.2px; resize: none; height: 100%; background-color: azure; overflow: hidden; text-align: center; color: black;" disabled></textarea>
                </div>
                <div class="total">
                    <h4>Total</h4>
                    <textarea id="Textarea_REAC_Total" readonly style="width: 71px; resize: none; height: 100%; background-color: azure; overflow: hidden; text-align: center; color: black;" disabled></textarea>
                </div>
            </div>

            <!-- Apparent Power -->
            <div class="apparent_power"><h3>Apparent Power(VA)</h3>
                <div class="phase_A">
                    <h4>Phase A</h4>
                    <textarea id="Textarea_APP_phase_A" readonly style="width: 71px; resize: none; height: 100%; background-color: azure; overflow: hidden; text-align: center; color: black;" disabled></textarea>
                </div>
                <div class="phase_B">
                    <h4>Phase B</h4>
                    <textarea id="Textarea_APP_phase_B" readonly style="width: 71px; resize: none; height: 100%; background-color: azure; overflow: hidden; text-align: center; color: black;" disabled></textarea>
                </div>
                <div class="phase_C">
                    <h4>Phase C</h4>
                    <textarea id="Textarea_APP_phase_C" readonly style="width: 71.2px; resize: none; height: 100%; background-color: azure; overflow: hidden; text-align: center; color: black;" disabled></textarea>
                </div>
                <div class="total">
                    <h4>Total</h4>
                    <textarea id="Textarea_APP_Total" readonly style="width: 71px; resize: none; height: 100%; background-color: azure; overflow: hidden; text-align: center; color: black;" disabled></textarea>
                </div>
            </div>

            <!-- Voltage -->
            <div class="voltage"><h3>Voltage(V)</h3>
                <div class="phase_A">
                    <h4>Phase A</h4>
                    <textarea id="Textarea_voltage_phase_A" readonly style="width: 71.4px; resize: none; height: 100%; background-color: azure; overflow: hidden; text-align: center; color: black;" disabled></textarea>
                </div>
                <div class="phase_B">
                    <h4>Phase B</h4>
                    <textarea id="Textarea_voltage_phase_B" readonly style="width: 70.6px; resize: none; height: 100%; background-color: azure; overflow: hidden; text-align: center; color: black;" disabled></textarea>
                </div>
                <div class="phase_C">
                    <h4>Phase C</h4>
                    <textarea id="Textarea_voltage_phase_C" readonly style="width: 71px; resize: none; height: 100%; background-color: azure; overflow: hidden; text-align: center; color: black;" disabled></textarea>
                </div>
            </div>

            <!-- Current -->
            <div class="current"><h3>Current(A)</h3>
                <div class="phase_A">
                    <h4>Phase A</h4>
                    <textarea id="Textarea_current_phase_A" readonly style="width: 71px; resize: none; height: 100%; background-color: azure; overflow: hidden; text-align: center; color: black;" disabled></textarea>
                </div>
                <div class="phase_B">
                    <h4>Phase B</h4>
                    <textarea id="Textarea_current_phase_B" readonly style="width: 71px; resize: none; height: 100%; background-color: azure; overflow: hidden; text-align: center; color: black;" disabled></textarea>
                </div>
                <div class="phase_C">
                    <h4>Phase C</h4>
                    <textarea id="Textarea_current_phase_C" readonly style="width: 71.2px; resize: none; height: 100%; background-color: azure; overflow: hidden; text-align: center; color: black;" disabled></textarea>
                </div>
                <div class="total">
                    <h4>Total</h4>
                    <textarea id="Textarea_current_Total" readonly style="width: 71px; resize: none; height: 100%; background-color: azure; overflow: hidden; text-align: center; color: black;" disabled></textarea>
                </div>
            </div>

             <!-- Power Factor -->
             <div class="power_factor"><h3>Power Factor(PF)</h3>
                <div class="phase_A">
                    <h4>Phase A</h4>
                    <textarea id="Textarea_PF_phase_A" readonly style="width: 71.4px; resize: none; height: 100%; background-color: azure; overflow: hidden; text-align: center; color: black;" disabled></textarea>
                </div>
                <div class="phase_B">
                    <h4>Phase B</h4>
                    <textarea id="Textarea_PF_phase_B" readonly style="width: 70.6px; resize: none; height: 100%; background-color: azure; overflow: hidden; text-align: center; color: black;" disabled></textarea>
                </div>
                <div class="phase_C">
                    <h4>Phase C</h4>
                    <textarea id="Textarea_PF_phase_C" readonly style="width: 71px; resize: none; height: 100%; background-color: azure; overflow: hidden; text-align: center; color: black;" disabled></textarea>
                </div>
            </div>

            <!-- Zero Sequence Current -->
            <div class="zero_sequence_current"><h3>Zero Sequence Current(A)</h3>
                <div class="total">
                    <h4>Total</h4>
                    <textarea id="Textarea_ZSC_Total" readonly style="width: 96px; resize: none; height: 100%; background-color: azure; overflow: hidden; text-align: center; color: black;" disabled></textarea>
                </div>
            </div>

            <!-- Current Unbalance -->
            <div class="current_unbalance"><h3>Current Unbalance</h3>
                <div class="total">
                    <h4>Total</h4>
                    <textarea id="Textarea_CU_Total" readonly style="width: 96.6px; resize: none; height: 100%; background-color: azure; overflow: hidden; text-align: center; color: black;" disabled></textarea>
                </div>
            </div>

            
        </div>
            
        <div class="bottombar">

        </div>
        
    </div>




    <script>



        // Create a new Broadcast Channel with a specific name

        // ---Active Power
        const channel73 = new BroadcastChannel('dataChannel73');
        const channel74 = new BroadcastChannel('dataChannel74');
        const channel75 = new BroadcastChannel('dataChannel75');
        const channel76 = new BroadcastChannel('dataChannel76');

        // ---Reactive Power
        const channel77 = new BroadcastChannel('dataChannel77');
        const channel78 = new BroadcastChannel('dataChannel78');
        const channel79 = new BroadcastChannel('dataChannel79');
        const channel80 = new BroadcastChannel('dataChannel80');

        // ---Apparent Power
        const channel81 = new BroadcastChannel('dataChannel81');
        const channel82 = new BroadcastChannel('dataChannel82');
        const channel83 = new BroadcastChannel('dataChannel83');
        const channel84 = new BroadcastChannel('dataChannel84');

        // ---Voltage
        const channel85 = new BroadcastChannel('dataChannel85');
        const channel86 = new BroadcastChannel('dataChannel86');
        const channel87 = new BroadcastChannel('dataChannel87');

        // ---Current
        const channel88 = new BroadcastChannel('dataChannel88');
        const channel89 = new BroadcastChannel('dataChannel89');
        const channel90 = new BroadcastChannel('dataChannel90');
        const channel91 = new BroadcastChannel('dataChannel91');

        // ---Power Factor
        const channel92 = new BroadcastChannel('dataChannel92');
        const channel93 = new BroadcastChannel('dataChannel93');
        const channel94 = new BroadcastChannel('dataChannel94');

        // ---Zero Sequence Current
        const channel95 = new BroadcastChannel('dataChannel95');

        // ---Current Unbalance
        const channel96 = new BroadcastChannel('dataChannel96');





        // ---Active Power
        const dataDisplay1 = document.getElementById('Textarea_ACT_phase_A');
        let receivedMessages1 = 0;
        // Listen for messages from other browsing contexts
        channel73.onmessage = event => {
            // Display the received data in the textarea
            receivedMessages1++;
            if (receivedMessages1 <= 49) {
                dataDisplay1.value += `${event.data}\n`;
            }
        };
        const dataDisplay2 = document.getElementById('Textarea_ACT_phase_B');
        let receivedMessages2 = 0;
        channel74.onmessage = event => {
            receivedMessages2++;
            if (receivedMessages2 <= 49) {
                dataDisplay2.value += `${event.data}\n`;
            }
        };
        const dataDisplay3 = document.getElementById('Textarea_ACT_phase_C');
        let receivedMessages3 = 0;
        channel75.onmessage = event => {
            receivedMessages3++;
            if (receivedMessages3 <= 49) {
                dataDisplay3.value += `${event.data}\n`;
            }
        };
        const dataDisplay4 = document.getElementById('Textarea_ACT_Total');
        let receivedMessages4 = 0;
        channel76.onmessage = event => {
            receivedMessages4++;
            if (receivedMessages4 <= 49) {
                dataDisplay4.value += `${event.data}\n`;
            }
        };


        // ---Reactive Power
        const dataDisplay5 = document.getElementById('Textarea_REAC_phase_A');
        let receivedMessages5 = 0;
        channel77.onmessage = event => {
            receivedMessages5++;
            if (receivedMessages5 <= 49) {
                dataDisplay5.value += `${event.data}\n`;
            }
        };
        const dataDisplay6 = document.getElementById('Textarea_REAC_phase_B');
        let receivedMessages6 = 0;
        channel78.onmessage = event => {
            receivedMessages6++;
            if (receivedMessages6 <= 49) {
                dataDisplay6.value += `${event.data}\n`;
            }
        };
        const dataDisplay7 = document.getElementById('Textarea_REAC_phase_C');
        let receivedMessages7 = 0;
        channel79.onmessage = event => {
            receivedMessages7++;
            if (receivedMessages7 <= 49) {
                dataDisplay7.value += `${event.data}\n`;
            }
        };
        const dataDisplay8 = document.getElementById('Textarea_REAC_Total');
        let receivedMessages8 = 0;
        channel80.onmessage = event => {
            receivedMessages8++;
            if (receivedMessages8 <= 49) {
                dataDisplay8.value += `${event.data}\n`;
            }
        };


        // ---Apparent Power
        const dataDisplay9 = document.getElementById('Textarea_APP_phase_A');
        let receivedMessages9 = 0;
        channel81.onmessage = event => {
            receivedMessages9++;
            if (receivedMessages9 <= 49) {
                dataDisplay9.value += `${event.data}\n`;
            }
        };
        const dataDisplay10 = document.getElementById('Textarea_APP_phase_B');
        let receivedMessages10 = 0;
        channel82.onmessage = event => {
            receivedMessages10++;
            if (receivedMessages10 <= 49) {
                dataDisplay10.value += `${event.data}\n`;
            }
        };
        const dataDisplay11 = document.getElementById('Textarea_APP_phase_C');
        let receivedMessages11 = 0;
        channel83.onmessage = event => {
            receivedMessages11++;
            if (receivedMessages11 <= 49) {
                dataDisplay11.value += `${event.data}\n`;
            }
        };
        const dataDisplay12 = document.getElementById('Textarea_APP_Total');
        let receivedMessages12 = 0;
        channel84.onmessage = event => {
            receivedMessages12++;
            if (receivedMessages12 <= 49) {
                dataDisplay12.value += `${event.data}\n`;
            }
        };

        
        // ---Voltage
        const dataDisplay13 = document.getElementById('Textarea_voltage_phase_A');
        let receivedMessages13 = 0;
        channel85.onmessage = event => {
            receivedMessages13++;
            if (receivedMessages13 <= 49) {
                dataDisplay13.value += `${event.data}\n`;
            }
        };
        const dataDisplay14 = document.getElementById('Textarea_voltage_phase_B');
        let receivedMessages14 = 0;
        channel86.onmessage = event => {
            receivedMessages14++;
            if (receivedMessages14 <= 49) {
                dataDisplay14.value += `${event.data}\n`;
            }
        };
        const dataDisplay15 = document.getElementById('Textarea_voltage_phase_C');
        let receivedMessages15 = 0;
        channel87.onmessage = event => {
            receivedMessages15++;
            if (receivedMessages15 <= 49) {
                dataDisplay15.value += `${event.data}\n`;
            }
        };


        // ---Current
        const dataDisplay16 = document.getElementById('Textarea_current_phase_A');
        let receivedMessages16 = 0;
        channel88.onmessage = event => {
            receivedMessages16++;
            if (receivedMessages16 <= 49) {
                dataDisplay16.value += `${event.data}\n`;
            }
        };
        const dataDisplay17 = document.getElementById('Textarea_current_phase_B');
        let receivedMessages17 = 0;
        channel89.onmessage = event => {
            receivedMessages17++;
            if (receivedMessages17 <= 49) {
                dataDisplay17.value += `${event.data}\n`;
            }
        };
        const dataDisplay18 = document.getElementById('Textarea_current_phase_C');
        let receivedMessages18 = 0;
        channel90.onmessage = event => {
            receivedMessages18++;
            if (receivedMessages18 <= 49) {
                dataDisplay18.value += `${event.data}\n`;
            }
        };
        const dataDisplay19 = document.getElementById('Textarea_current_Total');
        let receivedMessages19 = 0;
        channel91.onmessage = event => {
            receivedMessages19++;
            if (receivedMessages19 <= 49) {
                dataDisplay19.value += `${event.data}\n`;
            }
        };


        // ---Power Factor
        const dataDisplay20 = document.getElementById('Textarea_PF_phase_A');
        let receivedMessages20 = 0;
        channel92.onmessage = event => {
            receivedMessages20++;
            if (receivedMessages20 <= 49) {
                dataDisplay20.value += `${event.data}\n`;
            }
        };
        const dataDisplay21 = document.getElementById('Textarea_PF_phase_B');
        let receivedMessages21 = 0;
        channel93.onmessage = event => {
            receivedMessages21++;
            if (receivedMessages21 <= 49) {
                dataDisplay21.value += `${event.data}\n`;
            }
        };
        const dataDisplay22 = document.getElementById('Textarea_PF_phase_C');
        let receivedMessages22 = 0;
        channel94.onmessage = event => {
            receivedMessages22++;
            if (receivedMessages22 <= 49) {
                dataDisplay22.value += `${event.data}\n`;
            }
        };


        // ---Zero Sequence Current
        const dataDisplay23 = document.getElementById('Textarea_ZSC_Total');
        let receivedMessages23 = 0;
        channel95.onmessage = event => {
            receivedMessages23++;
            if (receivedMessages23 <= 49) {
                dataDisplay23.value += `${event.data}\n`;
            }
        };


        // ---Current Unbalance
        const dataDisplay24 = document.getElementById('Textarea_CU_Total');
        let receivedMessages24 = 0;
        channel96.onmessage = event => {
            receivedMessages24++;
            if (receivedMessages24 <= 49) {
                dataDisplay24.value += `${event.data}\n`;
            }
        };


        function resetData() {
            // Reset the receiver to allow receiving messages again

            // ---Active Power
            dataDisplay1.value = '';  
            dataDisplay2.value = '';    
            dataDisplay3.value = '';
            dataDisplay4.value = '';

            // ---Reactive Power
            dataDisplay5.value = '';
            dataDisplay6.value = '';
            dataDisplay7.value = '';
            dataDisplay8.value = '';

            // ---Apparent Power
            dataDisplay9.value = '';
            dataDisplay10.value = '';
            dataDisplay11.value = '';
            dataDisplay12.value = '';

            // ---Voltage
            dataDisplay13.value = '';
            dataDisplay14.value = '';
            dataDisplay15.value = '';

            // ---Current
            dataDisplay16.value = '';
            dataDisplay17.value = '';
            dataDisplay18.value = '';
            dataDisplay19.value = '';

            // ---Power Factor
            dataDisplay20.value = '';
            dataDisplay21.value = '';
            dataDisplay22.value = '';

            // ---Zero Sequence Current
            dataDisplay23.value = '';

            // ---Current Unbalance
            dataDisplay24.value = '';
            receivedMessages = 0; //Clear without Receiving again
        }
 
    </script>
    
</body>
</html>