<!DOCTYPE html>
<html lang="en">
<head>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>View Data Log Feeder2</title>
    <link rel="icon" href="IMPROTECHS.jpg">
    <link rel="stylesheet" href="css/viewdata.css">
    <style>
        body{
            overflow: hidden;
        }
        span {
            /* display: inline-block; */
            justify-content: center;
            align-content: center;
            margin: auto;
        }

        button {
            /* Variables */
            --button_radius: 17.5px;
            --button_color: #e8e8e8;
            --button_outline_color: #000000;
            font-size: 17px;
            font-weight: bold;
            margin-top: 30px;
            margin-left: 40px;
            margin-right: 560px;
            /* margin-bottom: -20px ; */
            border: none;
            border-radius: var(--button_radius);
            background: var(--button_outline_color);
            }

            .button_top {
            display: block;
            box-sizing: border-box;
            border: 2px solid var(--button_outline_color);
            border-radius: var(--button_radius);
            padding: 10px 20px;
            background: var(--button_color);
            color: var(--button_outline_color);
            transform: translateY(-0.2em);
            transition: transform 0.1s ease;
            }

            button:hover .button_top {
            /* Pull the button upwards when hovered */
            transform: translateY(-0.33em);
            }

            button:active .button_top {
            /* Push the button downwards when pressed */
            transform: translateY(0);
            }
    </style>

</head>
<body>
    <div class="container">
        <div class="topbar"> 
            <button onclick="resetData()">
                <span class="button_top"> Reset Data Log
                </span>
            </button>      
            <span id="label_title">FEEDER 2 DATA LOG</span>
        </div>

        <div class="midlebar">
            <!-- Active Power -->
            <div class="active_power"><h3>Active Power(W)</h3>
                <div class="phase_A">
                    <h4>Phase A</h4>
                    <textarea id="Textarea_ACT_phase_A"  readonly style="width: 71px; resize: none; height: 749px; background-color: azure; overflow: hidden;  text-align: center; color: black;" disabled></textarea>
                </div>
                <div class="phase_B">
                    <h4>Phase B</h4>
                    <textarea id="Textarea_ACT_phase_B"  readonly style="width: 71px; resize: none; height: 749px; background-color: azure; overflow: hidden; text-align: center; color: black;" disabled></textarea>
                </div>
                <div class="phase_C">
                    <h4>Phase C</h4>
                    <textarea id="Textarea_ACT_phase_C"  readonly style="width: 71.2px; resize: none; height: 749px; background-color: azure; overflow: hidden; text-align: center; color: black;" disabled></textarea>
                </div>
                <div class="total">
                    <h4>Total</h4>
                    <textarea id="Textarea_ACT_Total"  readonly style="width: 71px; resize: none; height: 749px; background-color: azure; overflow: hidden; text-align: center; color: black;" disabled></textarea>
                </div>
            </div>

            <!-- Reactive Power -->
            <div class="reactive_power"><h3>Reactive Power(VAR)</h3>
                <div class="phase_A">
                    <h4>Phase A</h4>
                    <textarea id="Textarea_REAC_phase_A" readonly style="width: 71px; resize: none; height: 749px; background-color: azure; overflow: hidden; text-align: center; color: black;" disabled></textarea>
                </div>
                <div class="phase_B">
                    <h4>Phase B</h4>
                    <textarea id="Textarea_REAC_phase_B" readonly style="width: 71px; resize: none; height: 749px; background-color: azure; overflow: hidden; text-align: center; color: black;" disabled></textarea>
                </div>
                <div class="phase_C">
                    <h4>Phase C</h4>
                    <textarea id="Textarea_REAC_phase_C" readonly style="width: 71.2px; resize: none; height: 749px; background-color: azure; overflow: hidden; text-align: center; color: black;" disabled></textarea>
                </div>
                <div class="total">
                    <h4>Total</h4>
                    <textarea id="Textarea_REAC_Total" readonly style="width: 71px; resize: none; height: 749px; background-color: azure; overflow: hidden; text-align: center; color: black;" disabled></textarea>
                </div>
            </div>

            <!-- Apparent Power -->
            <div class="apparent_power"><h3>Apparent Power(VA)</h3>
                <div class="phase_A">
                    <h4>Phase A</h4>
                    <textarea id="Textarea_APP_phase_A" readonly style="width: 71px; resize: none; height: 749px; background-color: azure; overflow: hidden; text-align: center; color: black;" disabled></textarea>
                </div>
                <div class="phase_B">
                    <h4>Phase B</h4>
                    <textarea id="Textarea_APP_phase_B" readonly style="width: 71px; resize: none; height: 749px; background-color: azure; overflow: hidden; text-align: center; color: black;" disabled></textarea>
                </div>
                <div class="phase_C">
                    <h4>Phase C</h4>
                    <textarea id="Textarea_APP_phase_C" readonly style="width: 71.2px; resize: none; height: 749px; background-color: azure; overflow: hidden; text-align: center; color: black;" disabled></textarea>
                </div>
                <div class="total">
                    <h4>Total</h4>
                    <textarea id="Textarea_APP_Total" readonly style="width: 71px; resize: none; height: 749px; background-color: azure; overflow: hidden; text-align: center; color: black;" disabled></textarea>
                </div>
            </div>

            <!-- Voltage -->
            <div class="voltage"><h3>Voltage(V)</h3>
                <div class="phase_A">
                    <h4>Phase A</h4>
                    <textarea id="Textarea_voltage_phase_A" readonly style="width: 71.4px; resize: none; height: 749px; background-color: azure; overflow: hidden; text-align: center; color: black;" disabled></textarea>
                </div>
                <div class="phase_B">
                    <h4>Phase B</h4>
                    <textarea id="Textarea_voltage_phase_B" readonly style="width: 70.6px; resize: none; height: 749px; background-color: azure; overflow: hidden; text-align: center; color: black;" disabled></textarea>
                </div>
                <div class="phase_C">
                    <h4>Phase C</h4>
                    <textarea id="Textarea_voltage_phase_C" readonly style="width: 71px; resize: none; height: 749px; background-color: azure; overflow: hidden; text-align: center; color: black;" disabled></textarea>
                </div>
            </div>

            <!-- Current -->
            <div class="current"><h3>Current(A)</h3>
                <div class="phase_A">
                    <h4>Phase A</h4>
                    <textarea id="Textarea_current_phase_A" readonly style="width: 71px; resize: none; height: 749px; background-color: azure; overflow: hidden; text-align: center; color: black;" disabled></textarea>
                </div>
                <div class="phase_B">
                    <h4>Phase B</h4>
                    <textarea id="Textarea_current_phase_B" readonly style="width: 71px; resize: none; height: 749px; background-color: azure; overflow: hidden; text-align: center; color: black;" disabled></textarea>
                </div>
                <div class="phase_C">
                    <h4>Phase C</h4>
                    <textarea id="Textarea_current_phase_C" readonly style="width: 71.2px; resize: none; height: 749px; background-color: azure; overflow: hidden; text-align: center; color: black;" disabled></textarea>
                </div>
                <div class="total">
                    <h4>Total</h4>
                    <textarea id="Textarea_current_Total" readonly style="width: 71px; resize: none; height: 749px; background-color: azure; overflow: hidden; text-align: center; color: black;" disabled></textarea>
                </div>
            </div>

             <!-- Power Factor -->
             <div class="power_factor"><h3>Power Factor(PF)</h3>
                <div class="phase_A">
                    <h4>Phase A</h4>
                    <textarea id="Textarea_PF_phase_A" readonly style="width: 71.4px; resize: none; height: 749px; background-color: azure; overflow: hidden; text-align: center; color: black;" disabled></textarea>
                </div>
                <div class="phase_B">
                    <h4>Phase B</h4>
                    <textarea id="Textarea_PF_phase_B" readonly style="width: 70.6px; resize: none; height: 749px; background-color: azure; overflow: hidden; text-align: center; color: black;" disabled></textarea>
                </div>
                <div class="phase_C">
                    <h4>Phase C</h4>
                    <textarea id="Textarea_PF_phase_C" readonly style="width: 71px; resize: none; height: 749px; background-color: azure; overflow: hidden; text-align: center; color: black;" disabled></textarea>
                </div>
            </div>

            <!-- Zero Sequence Current -->
            <div class="zero_sequence_current"><h3>Zero Sequence Current(A)</h3>
                <div class="total">
                    <h4>Total</h4>
                    <textarea id="Textarea_ZSC_Total" readonly style="width: 96px; resize: none; height: 749px; background-color: azure; overflow: hidden; text-align: center; color: black;" disabled></textarea>
                </div>
            </div>

            <!-- Current Unbalance -->
            <div class="current_unbalance"><h3>Current Unbalance</h3>
                <div class="total">
                    <h4>Total</h4>
                    <textarea id="Textarea_CU_Total" readonly style="width: 96.6px; resize: none; height: 749px; background-color: azure; overflow: hidden; text-align: center; color: black;" disabled></textarea>
                </div>
            </div>

            
        </div>
            
        <div class="bottombar">

        </div>
        
    </div>




    <script>



        // Create a new Broadcast Channel with a specific name

        // ---Active Power
        const channel25 = new BroadcastChannel('dataChannel25');
        const channel26 = new BroadcastChannel('dataChannel26');
        const channel27 = new BroadcastChannel('dataChannel27');
        const channel28 = new BroadcastChannel('dataChannel28');

        // ---Reactive Power
        const channel29 = new BroadcastChannel('dataChannel29');
        const channel30 = new BroadcastChannel('dataChannel30');
        const channel31 = new BroadcastChannel('dataChannel31');
        const channel32 = new BroadcastChannel('dataChannel32');

        // ---Apparent Power
        const channel33 = new BroadcastChannel('dataChannel33');
        const channel34 = new BroadcastChannel('dataChannel34');
        const channel35 = new BroadcastChannel('dataChannel35');
        const channel36 = new BroadcastChannel('dataChannel36');

        // ---Voltage
        const channel37 = new BroadcastChannel('dataChannel37');
        const channel38 = new BroadcastChannel('dataChannel38');
        const channel39 = new BroadcastChannel('dataChannel39');

        // ---Current
        const channel40 = new BroadcastChannel('dataChannel40');
        const channel41 = new BroadcastChannel('dataChannel41');
        const channel42 = new BroadcastChannel('dataChannel42');
        const channel43 = new BroadcastChannel('dataChannel43');

        // ---Power Factor
        const channel44 = new BroadcastChannel('dataChannel44');
        const channel45 = new BroadcastChannel('dataChannel45');
        const channel46 = new BroadcastChannel('dataChannel46');

        // ---Zero Sequence Current
        const channel47 = new BroadcastChannel('dataChannel47');

        // ---Current Unbalance
        const channel48 = new BroadcastChannel('dataChannel48');





        // ---Active Power
        const dataDisplay1 = document.getElementById('Textarea_ACT_phase_A');
        let receivedMessages1 = 0;
        // Listen for messages from other browsing contexts
        channel25.onmessage = event => {
            // Display the received data in the textarea
            receivedMessages1++;
            if (receivedMessages1 <= 50) {
                dataDisplay1.value += `${event.data}\n`;
            }
        };
        const dataDisplay2 = document.getElementById('Textarea_ACT_phase_B');
        let receivedMessages2 = 0;
        channel26.onmessage = event => {
            receivedMessages2++;
            if (receivedMessages2 <= 50) {
                dataDisplay2.value += `${event.data}\n`;
            }
        };
        const dataDisplay3 = document.getElementById('Textarea_ACT_phase_C');
        let receivedMessages3 = 0;
        channel27.onmessage = event => {
            receivedMessages3++;
            if (receivedMessages3 <= 50) {
                dataDisplay3.value += `${event.data}\n`;
            }
        };
        const dataDisplay4 = document.getElementById('Textarea_ACT_Total');
        let receivedMessages4 = 0;
        channel28.onmessage = event => {
            receivedMessages4++;
            if (receivedMessages4 <= 50) {
                dataDisplay4.value += `${event.data}\n`;
            }
        };


        // ---Reactive Power
        const dataDisplay5 = document.getElementById('Textarea_REAC_phase_A');
        let receivedMessages5 = 0;
        channel29.onmessage = event => {
            receivedMessages5++;
            if (receivedMessages5 <= 50) {
                dataDisplay5.value += `${event.data}\n`;
            }
        };
        const dataDisplay6 = document.getElementById('Textarea_REAC_phase_B');
        let receivedMessages6 = 0;
        channel30.onmessage = event => {
            receivedMessages6++;
            if (receivedMessages6 <= 50) {
                dataDisplay6.value += `${event.data}\n`;
            }
        };
        const dataDisplay7 = document.getElementById('Textarea_REAC_phase_C');
        let receivedMessages7 = 0;
        channel31.onmessage = event => {
            receivedMessages7++;
            if (receivedMessages7 <= 50) {
                dataDisplay7.value += `${event.data}\n`;
            }
        };
        const dataDisplay8 = document.getElementById('Textarea_REAC_Total');
        let receivedMessages8 = 0;
        channel32.onmessage = event => {
            receivedMessages8++;
            if (receivedMessages8 <= 50) {
                dataDisplay8.value += `${event.data}\n`;
            }
        };


        // ---Apparent Power
        const dataDisplay9 = document.getElementById('Textarea_APP_phase_A');
        let receivedMessages9 = 0;
        channel33.onmessage = event => {
            receivedMessages9++;
            if (receivedMessages9 <= 50) {
                dataDisplay9.value += `${event.data}\n`;
            }
        };
        const dataDisplay10 = document.getElementById('Textarea_APP_phase_B');
        let receivedMessages10 = 0;
        channel34.onmessage = event => {
            receivedMessages10++;
            if (receivedMessages10 <= 50) {
                dataDisplay10.value += `${event.data}\n`;
            }
        };
        const dataDisplay11 = document.getElementById('Textarea_APP_phase_C');
        let receivedMessages11 = 0;
        channel35.onmessage = event => {
            receivedMessages11++;
            if (receivedMessages11 <= 50) {
                dataDisplay11.value += `${event.data}\n`;
            }
        };
        const dataDisplay12 = document.getElementById('Textarea_APP_Total');
        let receivedMessages12 = 0;
        channel36.onmessage = event => {
            receivedMessages12++;
            if (receivedMessages12 <= 50) {
                dataDisplay12.value += `${event.data}\n`;
            }
        };

        
        // ---Voltage
        const dataDisplay13 = document.getElementById('Textarea_voltage_phase_A');
        let receivedMessages13 = 0;
        channel37.onmessage = event => {
            receivedMessages13++;
            if (receivedMessages13 <= 50) {
                dataDisplay13.value += `${event.data}\n`;
            }
        };
        const dataDisplay14 = document.getElementById('Textarea_voltage_phase_B');
        let receivedMessages14 = 0;
        channel38.onmessage = event => {
            receivedMessages14++;
            if (receivedMessages14 <= 50) {
                dataDisplay14.value += `${event.data}\n`;
            }
        };
        const dataDisplay15 = document.getElementById('Textarea_voltage_phase_C');
        let receivedMessages15 = 0;
        channel39.onmessage = event => {
            receivedMessages15++;
            if (receivedMessages15 <= 50) {
                dataDisplay15.value += `${event.data}\n`;
            }
        };


        // ---Current
        const dataDisplay16 = document.getElementById('Textarea_current_phase_A');
        let receivedMessages16 = 0;
        channel40.onmessage = event => {
            receivedMessages16++;
            if (receivedMessages16 <= 50) {
                dataDisplay16.value += `${event.data}\n`;
            }
        };
        const dataDisplay17 = document.getElementById('Textarea_current_phase_B');
        let receivedMessages17 = 0;
        channel41.onmessage = event => {
            receivedMessages17++;
            if (receivedMessages17 <= 50) {
                dataDisplay17.value += `${event.data}\n`;
            }
        };
        const dataDisplay18 = document.getElementById('Textarea_current_phase_C');
        let receivedMessages18 = 0;
        channel42.onmessage = event => {
            receivedMessages18++;
            if (receivedMessages18 <= 50) {
                dataDisplay18.value += `${event.data}\n`;
            }
        };
        const dataDisplay19 = document.getElementById('Textarea_current_Total');
        let receivedMessages19 = 0;
        channel43.onmessage = event => {
            receivedMessages19++;
            if (receivedMessages19 <= 50) {
                dataDisplay19.value += `${event.data}\n`;
            }
        };


        // ---Power Factor
        const dataDisplay20 = document.getElementById('Textarea_PF_phase_A');
        let receivedMessages20 = 0;
        channel44.onmessage = event => {
            receivedMessages20++;
            if (receivedMessages20 <= 50) {
                dataDisplay20.value += `${event.data}\n`;
            }
        };
        const dataDisplay21 = document.getElementById('Textarea_PF_phase_B');
        let receivedMessages21 = 0;
        channel45.onmessage = event => {
            receivedMessages21++;
            if (receivedMessages21 <= 50) {
                dataDisplay21.value += `${event.data}\n`;
            }
        };
        const dataDisplay22 = document.getElementById('Textarea_PF_phase_C');
        let receivedMessages22 = 0;
        channel46.onmessage = event => {
            receivedMessages22++;
            if (receivedMessages22 <= 50) {
                dataDisplay22.value += `${event.data}\n`;
            }
        };


        // ---Zero Sequence Current
        const dataDisplay23 = document.getElementById('Textarea_ZSC_Total');
        let receivedMessages23 = 0;
        channel47.onmessage = event => {
            receivedMessages23++;
            if (receivedMessages23 <= 50) {
                dataDisplay23.value += `${event.data}\n`;
            }
        };


        // ---Current Unbalance
        const dataDisplay24 = document.getElementById('Textarea_CU_Total');
        let receivedMessages24 = 0;
        channel48.onmessage = event => {
            receivedMessages24++;
            if (receivedMessages24 <= 50) {
                dataDisplay24.value += `${event.data}\n`;
            }
        };


        function resetData() {
            // Reset the receiver to allow receiving messages again

            // ---Active Power
            dataDisplay1.value = '';  
            dataDisplay2.value = '';    
            dataDisplay3.value = '';
            dataDisplay4.value = '';

            // ---Reactive Power
            dataDisplay5.value = '';
            dataDisplay6.value = '';
            dataDisplay7.value = '';
            dataDisplay8.value = '';

            // ---Apparent Power
            dataDisplay9.value = '';
            dataDisplay10.value = '';
            dataDisplay11.value = '';
            dataDisplay12.value = '';

            // ---Voltage
            dataDisplay13.value = '';
            dataDisplay14.value = '';
            dataDisplay15.value = '';

            // ---Current
            dataDisplay16.value = '';
            dataDisplay17.value = '';
            dataDisplay18.value = '';
            dataDisplay19.value = '';

            // ---Power Factor
            dataDisplay20.value = '';
            dataDisplay21.value = '';
            dataDisplay22.value = '';

            // ---Zero Sequence Current
            dataDisplay23.value = '';

            // ---Current Unbalance
            dataDisplay24.value = '';
            

            // Reset All Line To Position Zero
            // ---Active Power
            receivedMessages1 = 0;
            receivedMessages2 = 0;
            receivedMessages3 = 0;
            receivedMessages4 = 0;

            // ---Reactive Power
            receivedMessages5 = 0;
            receivedMessages6 = 0;
            receivedMessages7 = 0;
            receivedMessages8 = 0;

            // ---Apparent Power
            receivedMessages9 = 0;
            receivedMessages10 = 0;
            receivedMessages11 = 0;
            receivedMessages12 = 0;

            // ---Voltage
            receivedMessages13 = 0;
            receivedMessages14 = 0;
            receivedMessages15 = 0;

            // ---Current
            receivedMessages16 = 0;
            receivedMessages17 = 0;
            receivedMessages18 = 0;
            receivedMessages19 = 0;

            // ---Power Factor
            receivedMessages20 = 0;
            receivedMessages21 = 0;
            receivedMessages22 = 0

            // ---Zero Sequence Current
            receivedMessages23 = 0;

            // ---Current Unbalance
            receivedMessages24 = 0;
        }
 
    </script>
    
</body>
</html>